---
createdAt: 2025/04/15
title: Rust演習の記録
description: The Rust Programming Languageに沿ってRustの演習を行い、その内容を記録する
tags: 
  - Rust
  - 備忘録
---

## アウトプット

<!-- TODO: Privateリポジトリになってるから、公開する -->
手元で作成したものは、[jonnity/rust-exercise](https://github.com/jonnity/rust-exercise)にコミットしている。


## へ～って思ったとこ

### 2章. 数当てゲームのプログラミング

* `let guess: u32 = guess.trim().parse().expect("Please type a number!");`みたいな、変数名使い回す (shadowing) 書き方ありなんだ (「2. 数当てゲームのプログラミング」内のコード)
  * 型付けがしっかりしてるのと、再定義を許可することって両立するんだね
  * 可読性とかの話としては同列に感じる (=再定義を乱用したら、意味わからんコードは書ける) けど、メモリ管理の観点からしたら、全然別の話ってことなのかも

### 3. 一般的なプログラミングの概念

* `const`ってそりゃ定数を表すよね
  * Javascript/Typescriptの、再代入を許さないだけのものを`const`で扱うの、なかなかな気がしてきたね
* 言語仕様として`let`で定義する変数はグローバル変数で定義できないという縛りがあるの、いいですね。
  * こういう仕様ってshadowingとは違って、可読性のためのものなのか？メモリ安全性にも寄与する？
  * 型付けが盤石なら、メモリ的にはグローバルでも一定だから、可読性のためなのかな
* 整数の基準型は`i32`、浮動小数点の基準型は`f64`なんだ
  * それぞれ↓の記載はあったけど、なんでなんだろ
    * 「64ビットシステム上でも、 この型 (`i32`) が普通最速になります。」
    * 「なぜなら、現代のCPUでは、(`f64`が) `f32`とほぼ同スピードにもかかわらず、より精度が高くなるからです。」
* ↓の記述 (Rustが配列の添字が適切かどうかをチェックするという話) は、他の言語だと実現が難しいんかな
  * 実行時の動作だから、なにもしないほうが楽というのはそりゃそうなんだろうけど、やってやれないことはない話？

> 低レベル言語の多くでは、 この種のチェックは行われないため、間違った添え字を与えると、無効なメモリにアクセスできてしまいます。 

* 仮引数 ("parameter") と実引数 ("argument") って概念、確かに両方とも引数って読んじゃうから意識的には区別できてなかったな
  * この辺、言語作るとかの水準の話しなければ、みんなそんなもんなのかしら
* ブロックの中 (最後？) の行にセミコロンを含むかどうかで、その行が式か文かが決まって、それによってブロック自体も式か文か決まるってこと？わかりにくくない？？
* `if`を式とすれば、三項演算子っていらないのか
  * 三項演算子的な書き方をしたいけど、わかりにくいよな～ってときもままあるから、これはいい仕様に思える

### 4. 所有権を理解する

* 所有権って何？と思ってたけど、「メモリのヒープ領域の管理のための仕組み」だという原理のとこから説明してもらえるから、やっぱこういう公式のドキュメントは読むべき
* 所有権という概念を成立させたまま、参照を使うとやりやすい、という説明の流れで、だいぶやりたいことがわかった気がする
* とはいえ、理解が浅いからあんまなんも言えんかも

### 5. 構造体を使用して関係のあるデータを構造化する

* ユニット様構造体、トレイトも何もわかってないからあれだけど、単にメンバを持たないクラスのインターフェースに使うみたいなこと？この辺に当てはめて考えるとわからんくなるんかな
* あとはまあ、そういう書き方なのね、という感じ

### 6. Enumとパターンマッチング

* typescriptの`enum`の型がゆるゆるだって話を踏まえてみるとすげーって感じ
* `if let`、この動作を`if let`で書くの、いまいちよくわかってない
  * 動作がよくわかってないのか、英語がよくわかっていないのか

### 7. 肥大化していくプロジェクトをパッケージ、クレート、モジュールを利用して管理する

* nodeの`package.json`と比べて、デフォルトの`cargo.toml`はシンプルでいいよね: `src/main.rs`/`src/lib.rs`がcrate rootになるよって話に関連して
* 標準非公開なの、いっぱい`pub`って書くことになって大変な気もするけどそんなもん？
  * むしろデフォルト`public`なTypescriptが変な気もするね
  * enumの要素はデフォルト`pub`らしいし、まあそんなもんか
* あとはまあ、書き方って感じ

### 8. 一般的なコレクション

* `String`と`str`は、所有権がうまいことなるように実装されてるよってくらいしか理解できんかった
  * それで困らないんだろうな、という感じはする。困ったら困ったときにもう一回見よ
* 普通にUnicodeとかのことももうちょっと知っておきたい気もする
  * そもそも興味あるっちゃある
* `or_insert`がその値への可変参照を返すのなんなん？わけわからんくならん？